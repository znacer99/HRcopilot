{% extends "dashboard/base_dashboard.html" %}
{% block dashboard_title %}{% if employee %}Edit Employee{% else %}Create Employee{% endif %}{% endblock %}

{% block dashboard_content %}
<div class="card">
  <div class="card-header">
    <h5>{% if employee %}Edit{% else %}Create{% endif %} Employee</h5>
  </div>
  <div class="card-body">
    <form method="POST" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <div class="mb-3">
        <label class="form-label">Full name</label>
        <input name="name" class="form-control" value="{{ employee.name if employee else '' }}" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Email</label>
        <input name="email" type="email" class="form-control" value="{{ employee.email if employee else '' }}" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Phone</label>
        <input name="phone" type="text" class="form-control" value="{{ employee.phone if employee else '' }}">
      </div>

      <div class="mb-3">
        <label class="form-label">Position / Title</label>
        <input name="position" type="text" class="form-control" value="{{ employee.position if employee else '' }}">
      </div>

      <div class="mb-3">
        <label class="form-label">Role</label>
        <select name="role" class="form-select" required>
          {% set current_role = employee.role if employee else '' %}
          <option value="employee" {% if current_role=='employee' %}selected{% endif %}>Employee</option>
          <option value="manager" {% if current_role=='manager' %}selected{% endif %}>Manager</option>
          <option value="head_of_department" {% if current_role=='head_of_department' %}selected{% endif %}>Head of Department</option>
          <option value="general_manager" {% if current_role=='general_manager' %}selected{% endif %}>General Manager</option>
          <option value="general_director" {% if current_role=='general_director' %}selected{% endif %}>General Director</option>
          <option value="it_manager" {% if current_role=='it_manager' %}selected{% endif %}>IT Manager</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Department</label>
        <select name="department" class="form-select">
          <option value="">-- none --</option>
          {% for d in departments %}
            <option value="{{ d.id }}" {% if employee and employee.department_id == d.id %}selected{% endif %}>{{ d.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Access code (optional)</label>
        <input name="access_code" class="form-control" value="{{ employee.access_code if employee else '' }}">
      </div>

      <div class="mb-3">
        <label class="form-label">Avatar (optional)</label>
        <input name="avatar" type="text" class="form-control" value="{{ employee.avatar if employee else '' }}" placeholder="e.g. initials or emoji">
      </div>

      <div class="mb-3">
        <label class="form-label">Password {% if not employee %}(required){% endif %}</label>
        <input name="password" type="password" class="form-control" {% if not employee %}required{% endif %}>
      </div>

      <div class="mb-3">
        <label class="form-label">Upload Documents (optional)</label>
        <input type="file" name="documents" class="form-control" multiple>
      </div>

      <div class="mt-3">
        <button type="submit" class="btn btn-primary">Save</button>
        <a href="{% if current_user.role == 'general_director' %}
            {{ url_for('dashboard.director_dashboard') }}
          {% elif current_user.role == 'it_manager' %}
            {{ url_for('dashboard.it_manager_dashboard') }}
          {% else %}
            {{ url_for('dashboard.role_dashboard') }}
          {% endif %}" class="btn btn-outline-secondary">
          ‚Üê Back to Dashboard
        </a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
