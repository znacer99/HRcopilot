{% extends "dashboard/base_dashboard.html" %}

{% block dashboard_title %}
  {{ "Edit User" if user else "Add User" }}
{% endblock %}

{% block dashboard_content %}
<div class="card">
  <div class="card-header">
    <h5 class="mb-0">{{ "Edit User" if user else "Create User" }}</h5>
  </div>
  <div class="card-body">
    <form method="POST" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <div class="mb-3">
        <label for="name" class="form-label">Name</label>
        <input type="text" name="name" id="name" class="form-control"
               value="{{ user.name if user else '' }}" required>
      </div>

      <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input type="email" name="email" id="email" class="form-control"
               value="{{ user.email if user else '' }}" required>
      </div>

      <div class="mb-3">
        <label for="phone" class="form-label">Phone</label>
        <input type="text" name="phone" id="phone" class="form-control"
               value="{{ user.phone if user else '' }}">
      </div>

      <div class="mb-3">
        <label for="position" class="form-label">Position</label>
        <input type="text" name="position" id="position" class="form-control"
               value="{{ user.position if user else '' }}">
      </div>

      <div class="mb-3">
        <label for="role" class="form-label">Role</label>
        <select name="role" id="role" class="form-select" required>
          <option value="">Select Role</option>
          <option value="it_manager" {{ "selected" if user and user.role=="it_manager" }}>IT Manager</option>
          <option value="general_director" {{ "selected" if user and user.role=="general_director" }}>General Director</option>
          <option value="general_manager" {{ "selected" if user and user.role=="general_manager" }}>General Manager</option>
          <option value="head_of_department" {{ "selected" if user and user.role=="head_of_department" }}>Head of Department</option>
          <option value="manager" {{ "selected" if user and user.role=="manager" }}>Manager</option>
          <option value="employee" {{ "selected" if user and user.role=="employee" }}>Employee</option>
        </select>
      </div>

      {% if not user %}
      <div class="mb-3">
        <label for="password" class="form-label">Password</label>
        <input type="password" name="password" id="password" class="form-control" required>
      </div>
      {% endif %}

      <div class="mb-3">
        <label for="documents" class="form-label">Upload Documents</label>
        <input type="file" name="documents" id="documents" class="form-control" multiple>
      </div>

      <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('user.list_users') }}" class="btn btn-secondary">Cancel</a>
        <button type="submit" class="btn btn-primary">{{ "Update User" if user else "Create User" }}</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
